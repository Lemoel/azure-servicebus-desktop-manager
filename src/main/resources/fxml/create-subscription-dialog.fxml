<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<DialogPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.azureservicebus.manager.controller.CreateSubscriptionDialogController"
            prefWidth="700" prefHeight="650">
    
    <content>
        <VBox spacing="15" styleClass="dialog-container">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            
            <!-- TÃ­tulo -->
            <Label text="âž• Criar Nova Subscription com ConfiguraÃ§Ãµes" styleClass="dialog-title">
                <font>
                    <Font name="System Bold" size="16"/>
                </font>
            </Label>
            
            <Separator/>
            
            <!-- Nome da Subscription -->
            <VBox spacing="5">
                <Label text="Nome da Subscription:" styleClass="field-label">
                    <font>
                        <Font name="System Bold" size="12"/>
                    </font>
                </Label>
                <TextField fx:id="subscriptionNameField" promptText="Digite o nome da subscription..."/>
            </VBox>
            
            <!-- TabPane para configuraÃ§Ãµes -->
            <TabPane fx:id="configTabPane" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
                
                <!-- Aba: ConfiguraÃ§Ãµes de Entrega -->
                <Tab text="âš™ï¸ Entrega">
                    <ScrollPane fitToWidth="true">
                        <VBox spacing="15">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            
                            <!-- Max Delivery Count -->
                            <VBox spacing="5">
                                <Label text="Max Delivery Count:" styleClass="field-label">
                                    <font>
                                        <Font name="System Bold" size="11"/>
                                    </font>
                                </Label>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Spinner fx:id="maxDeliveryCountSpinner" editable="true" prefWidth="120"/>
                                    <Label text="tentativas antes de ir para Dead Letter" style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                                </HBox>
                            </VBox>
                            
                            <!-- Lock Duration -->
                            <VBox spacing="5">
                                <Label text="Lock Duration:" styleClass="field-label">
                                    <font>
                                        <Font name="System Bold" size="11"/>
                                    </font>
                                </Label>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Spinner fx:id="lockDurationSpinner" editable="true" prefWidth="120"/>
                                    <Label text="minuto(s) de bloqueio durante processamento" style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                                </HBox>
                            </VBox>
                            
                            <!-- Default Message TTL -->
                            <VBox spacing="5">
                                <Label text="Message Time To Live (TTL):" styleClass="field-label">
                                    <font>
                                        <Font name="System Bold" size="11"/>
                                    </font>
                                </Label>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Spinner fx:id="messageTtlSpinner" editable="true" prefWidth="120"/>
                                    <Label text="dia(s) de vida Ãºtil da mensagem" style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                                </HBox>
                            </VBox>
                            
                            <!-- Batched Operations -->
                            <CheckBox fx:id="batchedOperationsCheckBox" text="Habilitar OperaÃ§Ãµes em Lote (melhor performance)" selected="true">
                                <font>
                                    <Font size="11"/>
                                </font>
                            </CheckBox>
                        </VBox>
                    </ScrollPane>
                </Tab>
                
                <!-- Aba: Dead Letter -->
                <Tab text="ðŸ’€ Dead Letter">
                    <ScrollPane fitToWidth="true">
                        <VBox spacing="15">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            
                            <Label text="ConfiguraÃ§Ãµes de Dead Letter Queue (DLQ)" style="-fx-font-weight: bold;"/>
                            
                            <CheckBox fx:id="deadLetterOnExpirationCheckBox" 
                                     text="Enviar para DLQ quando mensagem expirar" wrapText="true">
                                <font>
                                    <Font size="11"/>
                                </font>
                            </CheckBox>
                            
                            <CheckBox fx:id="deadLetterOnFilterExceptionCheckBox" 
                                     text="Enviar para DLQ quando filtro lanÃ§ar exceÃ§Ã£o" wrapText="true">
                                <font>
                                    <Font size="11"/>
                                </font>
                            </CheckBox>
                            
                            <Label text="ðŸ’¡ DLQ armazena mensagens que nÃ£o puderam ser processadas com sucesso" 
                                   wrapText="true" style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                        </VBox>
                    </ScrollPane>
                </Tab>
                
                <!-- Aba: SessÃµes e Auto-Delete -->
                <Tab text="ðŸ”§ AvanÃ§ado">
                    <ScrollPane fitToWidth="true">
                        <VBox spacing="15">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            
                            <!-- SessÃµes -->
                            <VBox spacing="8">
                                <Label text="SessÃµes" style="-fx-font-weight: bold;"/>
                                <CheckBox fx:id="requiresSessionCheckBox" 
                                         text="Requer SessÃµes (FIFO por sessÃ£o)" wrapText="true">
                                    <font>
                                        <Font size="11"/>
                                    </font>
                                </CheckBox>
                                <Label text="âš ï¸ NÃ£o pode ser alterado apÃ³s criaÃ§Ã£o da subscription" 
                                       style="-fx-text-fill: #dc3545; -fx-font-size: 10px;"/>
                            </VBox>
                            
                            <Separator/>
                            
                            <!-- Auto Delete on Idle -->
                            <VBox spacing="8">
                                <Label text="Auto-Delete" style="-fx-font-weight: bold;"/>
                                <CheckBox fx:id="autoDeleteCheckBox" 
                                         text="Habilitar Auto-Delete quando inativa">
                                    <font>
                                        <Font size="11"/>
                                    </font>
                                </CheckBox>
                                <HBox fx:id="autoDeleteBox" spacing="10" alignment="CENTER_LEFT" visible="false" managed="false">
                                    <Label text="Inativa por:"/>
                                    <Spinner fx:id="autoDeleteHoursSpinner" editable="true" prefWidth="100"/>
                                    <Label text="hora(s)" style="-fx-text-fill: #666;"/>
                                </HBox>
                            </VBox>
                            
                            <Separator/>
                            
                            <!-- User Metadata -->
                            <VBox spacing="5">
                                <Label text="Metadados do UsuÃ¡rio (opcional):" style="-fx-font-weight: bold;"/>
                                <TextArea fx:id="userMetadataTextArea" prefRowCount="3" 
                                         promptText="InformaÃ§Ãµes customizadas sobre a subscription..."/>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </Tab>
                
                <!-- Aba: Encaminhamento -->
                <Tab text="â†—ï¸ Encaminhamento">
                    <ScrollPane fitToWidth="true">
                        <VBox spacing="15">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            
                            <!-- Forward To -->
                            <VBox spacing="8">
                                <CheckBox fx:id="forwardToCheckBox" 
                                         text="Encaminhar mensagens para outra fila/tÃ³pico">
                                    <font>
                                        <Font size="11"/>
                                    </font>
                                </CheckBox>
                                <TextField fx:id="forwardToField" 
                                          promptText="Nome da fila ou tÃ³pico de destino"
                                          visible="false" managed="false"/>
                            </VBox>
                            
                            <Separator/>
                            
                            <!-- Forward Dead Lettered Messages -->
                            <VBox spacing="8">
                                <CheckBox fx:id="forwardDeadLetterCheckBox" 
                                         text="Encaminhar mensagens DLQ para outra fila/tÃ³pico">
                                    <font>
                                        <Font size="11"/>
                                    </font>
                                </CheckBox>
                                <TextField fx:id="forwardDeadLetterField" 
                                          promptText="Nome da fila ou tÃ³pico de destino para DLQ"
                                          visible="false" managed="false"/>
                            </VBox>
                            
                            <Label text="ðŸ’¡ Encaminhamento automÃ¡tico permite criar pipelines de processamento" 
                                   wrapText="true" style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                        </VBox>
                    </ScrollPane>
                </Tab>
                
                <!-- Aba: Filtros -->
                <Tab text="ðŸ” Filtros">
                    <ScrollPane fitToWidth="true">
                        <VBox spacing="15">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            
                            <!-- CheckBox para habilitar filtro -->
                            <CheckBox fx:id="enableFilterCheckBox" text="â˜‘ Configurar filtro para mensagens">
                                <font>
                                    <Font name="System Bold" size="12"/>
                                </font>
                            </CheckBox>
                            
                            <!-- SeÃ§Ã£o de configuraÃ§Ã£o de filtro -->
                            <VBox fx:id="filterSection" spacing="15" visible="false" managed="false" 
                                  style="-fx-border-color: #e0e0e0; -fx-border-width: 1; -fx-border-radius: 5; -fx-background-color: #f9f9f9; -fx-background-radius: 5;">
                                <padding>
                                    <Insets top="15" right="15" bottom="15" left="15"/>
                                </padding>
                                
                                <!-- Tipo de filtro -->
                                <VBox spacing="5">
                                    <Label text="Tipo de Filtro:" styleClass="field-label"/>
                                    <ComboBox fx:id="filterTypeComboBox" prefWidth="200" promptText="Selecione o tipo..."/>
                                </VBox>
                                
                                <!-- SQL Filter Section -->
                                <VBox fx:id="sqlFilterSection" spacing="5" visible="false" managed="false">
                                    <Label text="ExpressÃ£o SQL:" styleClass="field-label"/>
                                    <TextArea fx:id="sqlExpressionTextArea" prefHeight="80" wrapText="true"
                                              promptText="Exemplo: type = 'order' AND priority > 5"/>
                                    <Label text="ðŸ’¡ Filtra mensagens com base em propriedades e corpo" 
                                           style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                                </VBox>
                                
                                <!-- Correlation Filter Section -->
                                <VBox fx:id="correlationFilterSection" spacing="10" visible="false" managed="false">
                                    <Label text="Propriedades do Correlation Filter:" styleClass="field-label"/>
                                    
                                    <GridPane hgap="10" vgap="8">
                                        <columnConstraints>
                                            <ColumnConstraints percentWidth="50"/>
                                            <ColumnConstraints percentWidth="50"/>
                                        </columnConstraints>
                                        
                                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <Label text="Correlation ID:" style="-fx-font-size: 11px;"/>
                                            <TextField fx:id="correlationIdField" promptText="ID de correlaÃ§Ã£o"/>
                                        </VBox>
                                        
                                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <Label text="Message ID:" style="-fx-font-size: 11px;"/>
                                            <TextField fx:id="messageIdField" promptText="ID da mensagem"/>
                                        </VBox>
                                        
                                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                            <Label text="Session ID:" style="-fx-font-size: 11px;"/>
                                            <TextField fx:id="sessionIdField" promptText="ID da sessÃ£o"/>
                                        </VBox>
                                        
                                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                            <Label text="Reply To:" style="-fx-font-size: 11px;"/>
                                            <TextField fx:id="replyToField" promptText="EndereÃ§o de resposta"/>
                                        </VBox>
                                        
                                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="2">
                                            <Label text="Label:" style="-fx-font-size: 11px;"/>
                                            <TextField fx:id="labelField" promptText="RÃ³tulo da mensagem"/>
                                        </VBox>
                                        
                                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                            <Label text="Content Type:" style="-fx-font-size: 11px;"/>
                                            <TextField fx:id="contentTypeField" promptText="application/json"/>
                                        </VBox>
                                    </GridPane>
                                    
                                    <Label text="ðŸ’¡ Filtra mensagens com base em propriedades do cabeÃ§alho" 
                                           style="-fx-text-fill: #666; -fx-font-size: 10px;"/>
                                </VBox>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </Tab>
                
            </TabPane>
            
            <!-- Nota informativa -->
            <HBox spacing="5" alignment="CENTER_LEFT" 
                  style="-fx-background-color: #d1ecf1; -fx-padding: 10; -fx-border-color: #17a2b8; -fx-border-width: 1; -fx-border-radius: 5; -fx-background-radius: 5;">
                <Label text="â„¹ï¸" style="-fx-font-size: 16px;"/>
                <Label fx:id="infoLabel" 
                       text="Todas as configuraÃ§Ãµes sÃ£o opcionais. Valores padrÃ£o serÃ£o usados se nÃ£o especificado." 
                       wrapText="true" style="-fx-font-size: 10px;"/>
            </HBox>
        </VBox>
    </content>
    
    <buttonTypes>
        <ButtonType fx:constant="OK"/>
        <ButtonType fx:constant="CANCEL"/>
    </buttonTypes>
    
</DialogPane>
