<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<DialogPane xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.azureservicebus.manager.controller.RulesDialogController"
            prefHeight="600.0" prefWidth="800.0">
   
   <content>
      <VBox spacing="15.0">
         <padding>
            <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
         </padding>
         
         <!-- Header com info da Subscription -->
         <HBox alignment="CENTER_LEFT" spacing="10.0" styleClass="info-banner">
            <padding>
               <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
            </padding>
            <Label text="ðŸ“Š TÃ³pico:" />
            <Label fx:id="topicNameLabel" text="topic-name" styleClass="info-value">
               <font>
                  <Font name="System Bold" size="12.0" />
               </font>
            </Label>
            <Label text="ðŸ“§ Subscription:" />
            <Label fx:id="subscriptionNameLabel" text="subscription-name" styleClass="info-value">
               <font>
                  <Font name="System Bold" size="12.0" />
               </font>
            </Label>
         </HBox>
         
         <!-- Rules Existentes -->
         <VBox spacing="10.0">
            <Label styleClass="section-title" text="ðŸ“œ Rules Existentes">
               <font>
                  <Font name="System Bold" size="14.0" />
               </font>
            </Label>
            
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <Button fx:id="refreshRulesButton" text="ðŸ”„ Atualizar" styleClass="secondary-button" />
               <Region HBox.hgrow="ALWAYS" />
               <Label fx:id="rulesCountLabel" text="0 rules" styleClass="info-text" />
            </HBox>
            
            <TableView fx:id="rulesTable" prefHeight="200.0">
               <columns>
                  <TableColumn fx:id="ruleNameColumn" prefWidth="120.0" text="Nome" />
                  <TableColumn fx:id="ruleFilterTypeColumn" prefWidth="90.0" text="Tipo Filtro" />
                  <TableColumn fx:id="ruleFilterExpressionColumn" prefWidth="400.0" text="ExpressÃ£o do Filtro" />
                  <TableColumn fx:id="ruleActionsColumn" prefWidth="70.0" text="AÃ§Ãµes" sortable="false" />
               </columns>
               <placeholder>
                  <Label text="Nenhuma rule encontrada. A rule '$Default' Ã© criada automaticamente." />
               </placeholder>
            </TableView>
            
            <Label styleClass="help-text" text="ðŸ’¡ A rule '$Default' com TrueFilter aceita todas as mensagens. Adicione rules customizadas para filtrar mensagens especÃ­ficas." wrapText="true" />
         </VBox>
         
         <!-- Criar/Editar Rule -->
         <Separator />
         
         <VBox spacing="10.0" styleClass="action-section">
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <Label fx:id="formTitleLabel" styleClass="section-title" text="âž• Criar Nova Rule">
                  <font>
                     <Font name="System Bold" size="14.0" />
                  </font>
               </Label>
               <Region HBox.hgrow="ALWAYS" />
               <Button fx:id="newRuleButton" text="ðŸ†• Nova Rule" styleClass="secondary-button" managed="false" visible="false" />
            </HBox>
            
            <!-- Nome da Rule -->
            <HBox spacing="10.0" alignment="CENTER_LEFT">
               <Label text="Nome da Rule:" minWidth="120.0" />
               <TextField fx:id="newRuleNameField" promptText="Ex: high-priority, orders-filter" HBox.hgrow="ALWAYS" />
            </HBox>
            
            <!-- Tipo de Filtro -->
            <HBox spacing="10.0" alignment="CENTER_LEFT">
               <Label text="Tipo de Filtro:" minWidth="120.0" />
               <ComboBox fx:id="filterTypeComboBox" promptText="Selecione o tipo de filtro" HBox.hgrow="ALWAYS" />
            </HBox>
            
            <!-- ExpressÃ£o SQL (visÃ­vel apenas para SQL Filter) -->
            <VBox fx:id="sqlFilterSection" spacing="5.0" managed="false" visible="false">
               <Label text="ExpressÃ£o SQL:" />
               <TextArea fx:id="sqlExpressionTextArea" promptText="Ex: priority > 5 AND type = 'order'" prefRowCount="3" wrapText="true" />
               <Label styleClass="help-text" text="ðŸ’¡ Exemplos: color='red', quantity>10, type IN ('A','B'), priority BETWEEN 1 AND 10" wrapText="true" />
            </VBox>
            
            <!-- Correlation Filter (visÃ­vel apenas para Correlation Filter) -->
            <VBox fx:id="correlationFilterSection" spacing="5.0" managed="false" visible="false">
               <Label text="Propriedades de CorrelaÃ§Ã£o:" />
               <GridPane hgap="10.0" vgap="5.0">
                  <columnConstraints>
                     <ColumnConstraints hgrow="SOMETIMES" minWidth="120.0" />
                     <ColumnConstraints hgrow="ALWAYS" />
                  </columnConstraints>
                  
                  <Label text="Correlation ID:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                  <TextField fx:id="correlationIdField" promptText="ID de correlaÃ§Ã£o" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                  
                  <Label text="Message ID:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                  <TextField fx:id="messageIdField" promptText="ID da mensagem" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                  
                  <Label text="Session ID:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                  <TextField fx:id="sessionIdField" promptText="ID da sessÃ£o" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                  
                  <Label text="Reply To:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                  <TextField fx:id="replyToField" promptText="Responder para" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                  
                  <Label text="Label:" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                  <TextField fx:id="labelField" promptText="Label/Subject" GridPane.columnIndex="1" GridPane.rowIndex="4" />
                  
                  <Label text="Content Type:" GridPane.columnIndex="0" GridPane.rowIndex="5" />
                  <TextField fx:id="contentTypeField" promptText="Tipo de conteÃºdo" GridPane.columnIndex="1" GridPane.rowIndex="5" />
               </GridPane>
               <Label styleClass="help-text" text="ðŸ’¡ Correlation Filter Ã© mais performÃ¡tico que SQL Filter. Preencha apenas os campos necessÃ¡rios." wrapText="true" />
            </VBox>
            
            <!-- BotÃµes de AÃ§Ã£o -->
            <HBox alignment="CENTER_RIGHT" spacing="10.0">
               <padding>
                  <Insets top="10.0" />
               </padding>
               <Button fx:id="cancelEditButton" text="âŒ Cancelar" styleClass="secondary-button" managed="false" visible="false" />
               <Button fx:id="createRuleButton" text="âœ… Criar Rule" styleClass="success-button" />
            </HBox>
         </VBox>
      </VBox>
   </content>
   
   <expandableContent>
      <!-- Pode ser usado futuramente para opÃ§Ãµes avanÃ§adas -->
   </expandableContent>
</DialogPane>
